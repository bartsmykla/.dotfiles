{
  "$schema": "https://lnav.org/schemas/format-v1.schema.json",
  "kuma_log": {
    "title": "Kuma control-plane log",
    "description": "Kuma components write tab-separated lines: <ts>\\t<level>\\t<logger>\\t<message>[\\t<json>]",
    "file-pattern": ".*(kuma|kong-mesh)(-control-plane)?.*\\.log(\\.(txt|tsv))?$",

    "regex": {
      "main": {
        "pattern": "^(?<ts>\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}[+-]\\d{4})\\t(?<level>[A-Z]+)\\t(?<logger>[^\\t]+)\\t(?<body>[^\t]*)(?:\\t(?<json>\\{.*\\}))?$"
      }
    },

    "timestamp-field": "ts",
    "timestamp-format": ["%Y-%m-%dT%H:%M:%S.%L%z"],

    "level-field": "level",
    "level": {
      "fatal": "^FATAL$",
      "critical": "^CRIT(?:ICAL)?$",
      "error": "^ERROR$",
      "warning": "^WARN(?:ING)?$",
      "info": "^INFO$",
      "debug": "^DEBUG$",
      "trace": "^TRACE$"
    },

    "value": {
      "logger": {
        "kind": "string",
        "identifier": true
      },
      "json": {
        "kind": "json"
      }
    },

    "sample": [
      {
        "line": "2025-07-27T12:44:46.446+0200\tINFO\tdp-server\thttp: TLS handshake error from 10.42.0.226:53012: EOF"
      },
      {
        "line": "2025-07-27T12:44:48.226+0200\tINFO\txds.reconcile\tconfig has changed\t{\"proxyName\":\"kong-mesh-ingress-d9b497dcd-krt5m.kong-mesh-system\",\"mesh\":\"\",\"versions\":[\"b4f9d564-99e1-4134-8eb2-463bf4fb43ed\"]}"
      }
    ]
  }
}
