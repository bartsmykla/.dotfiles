{
  "$schema": "https://lnav.org/schemas/format-v1.schema.json",
  "kuma_control_plane_logs": {
    "title": "Kuma/Kong Mesh control plane log",
    "regex": {
      "std": {
        "pattern": "^(?:(?<container>[^ ]+) (?<component>[^ ]+) )?(?<level_letter>[DIWEF])?(?<timestamp>\\d{4}[-\\/]\\d{2}[-\\/]\\d{2}[T ]\\d{2}:\\d{2}:\\d{2}(?:[,.]\\d{3}(?:Z|[-+]\\d{2}:?\\d{2})?)?|\\d{2}\\d{2}\\s+\\d{2}:\\d{2}:\\d{2}\\.\\d{6})(?:(?:\\t(?<level>DEBUG|INFO|WARN|ERROR|FATAL))?(?:[\\t ](?<logger>[^\\s:]+):?)[\\t ]|\\s+(?<pid>\\d+)\\s+(?<src_file>[^:]+):(?<src_line>\\d+)\\]\\s+)(?<body>.*?)(?:\\t(?<properties>\\{.*\\}))?$"
      }
    },
    "multiline": true,
    "ordered-by-time": false,
    "timestamp-format": [
      "%Y-%m-%dT%H:%M:%S.%L%z",
      "%Y/%m/%d %H:%M:%S",
      "%m%d %H:%M:%S.%f"
    ],
    "level-field": "level",
    "level": {
      "debug": "^DEBUG$",
      "info": "^INFO$",
      "warning": "^WARN$",
      "error": "^ERROR$",
      "fatal": "^FATAL$"
    },
    "value": {
      "timestamp": {
        "kind": "string"
      },
      "container": {
        "kind": "string",
        "identifier": true
      },
      "component": {
        "kind": "string",
        "identifier": true,
        "hidden": true
      },
      "logger": {
        "kind": "string",
        "identifier": true
      },
      "level": {
        "kind": "string",
        "identifier": true
      },
      "body": {
        "kind": "string"
      },
      "properties": {
        "kind": "json"
      },
      "pid": {
        "kind": "integer",
        "identifier": true,
        "hidden": true
      },
      "src_file": {
        "kind": "string",
        "identifier": true
      },
      "src_line": {
        "kind": "integer",
        "foreign-key": true
      },
      "level_letter": {
        "kind": "string",
        "hidden": true
      }
    },
    "sample": [
      {
        "line": "2025-07-27T12:44:46.446+0200\tINFO\tdp-server\thttp: TLS handshake error from 10.42.0.226:53012: EOF"
      },
      {
        "line": "2025-07-27T12:44:46.519+0200\tINFO\tkds-zone\tdetected changes in the resources. Sending changes to the client.\t{\"streamID\": 2, \"nodeID\": \"kuma-1\", \"resourceType\": \"MeshService\", \"client\": \"global\"}"
      },
      {
        "line": "kong-mesh-control-plane-f7c754b88-cdjbs control-plane 2025-08-25T22:21:33.730Z\tINFO\trbac\taccess granted\t{\"attempt\": \"e59d3655-4644-4cbb-98fb-afb5182f1ec1\", \"access\": \"UPDATE\", \"key\": {\"Mesh\":\"dev-ppas\",\"Name\":\"kustomize-clms-ai-svc-to-clms-service-bus-port-443.clms-d0-automation-lab\"}, \"resourceType\": \"MeshTrafficPermission\", \"user\": \"system:serviceaccount:clms-d0-automation-lab:automation-lab-flux-sa/system:serviceaccounts,system:serviceaccounts:clms-d0-automation-lab,system:authenticated\"}"
      },
      {
        "line": "2025-07-27T12:44:46.519+0200\tINFO\tkds-zone\tdetected changes in the resources. Sending changes to the client.\t{\"streamID\": 2, \"nodeID\": \"kuma-1\", \"resourceType\": \"Dataplane\", \"client\": \"global\"}"
      },
      {
        "line": "2025-07-27T12:44:47.438+0200\tINFO\tdp-server\thttp: TLS handshake error from 10.42.0.227:45990: remote error: tls: bad certificate"
      },
      {
        "line": "2025-07-27T12:44:47.450+0200\tINFO\tdp-server\thttp: TLS handshake error from 10.42.0.226:53018: EOF"
      },
      {
        "line": "2025-07-27T12:44:47.973+0200\tINFO\tmeshmultizoneservice.status-updater\tupdating matched mesh services\t{\"meshmultizoneservice\": \"kv-d4x6xvdxb69b944v.kong-mesh-system\", \"matchedMeshServices\": [{\"name\":\"kv\",\"namespace\":\"kuma-demo\",\"zone\":\"kuma-1\",\"mesh\":\"default\"},{\"name\":\"kv\",\"namespace\":\"kuma-demo\",\"zone\":\"kuma-2\",\"mesh\":\"default\"}]}"
      },
      {
        "line": "2025-07-27T12:44:48.013+0200\tINFO\tdp-server\thttp: TLS handshake error from 10.42.0.229:38356: remote error: tls: bad certificate"
      },
      {
        "line": "2025-07-27T12:44:48.226+0200\tINFO\txds.reconcile\tconfig has changed\t{\"proxyName\": \"kong-mesh-ingress-d9b497dcd-krt5m.kong-mesh-system\", \"mesh\": \"\", \"versions\": [\"b4f9d564-99e1-4134-8eb2-463bf4fb43ed\"]}"
      },
      {
        "line": "2025-07-27T12:44:48.400+0200\tINFO\topa-server\tconfiguring OPA agent with a new config\t{\"nodeID\": \"default.demo-app-6954b89c5c-qhvpv.kuma-demo\"}"
      },
      {
        "line": "2025-07-27T12:44:48.610+0200\tINFO\tTEST\t\t{\"policies\": \"eyJUeXBlIjoiTWVzaFRDUFJvdXRlIiwiSW5ib3VuZFBvbGljaWVzIjpudWxsLCJPdXRib3VuZFBvbGljaWVzIjpudWxsLCJTZXJ2aWNlUG9saWNpZXMiOm51bGwsIkRhdGFwbGFuZVBvbGljaWVzIjpbXSwiRnJvbVJ1bGVzIjp7IlJ1bGVzIjp7fSwiSW5ib3VuZFJ1bGVzIjp7fX0sIlRvUnVsZXMiOnsiUnVsZXMiOltdLCJSZXNvdXJjZVJ1bGVzIjp7fX0sIkdhdGV3YXlSdWxlcyI6eyJUb1J1bGVzIjp7IkJ5TGlzdGVuZXIiOnt9LCJCeUxpc3RlbmVyQW5kSG9zdG5hbWUiOnt9fSwiRnJvbVJ1bGVzIjp7fSwiSW5ib3VuZFJ1bGVzIjp7fX0sIlNpbmdsZUl0ZW1SdWxlcyI6eyJSdWxlcyI6W119LCJXYXJuaW5ncyI6bnVsbH0=\"}"
      },
      {
        "line": "2025-07-27T12:44:48.610+0200\tINFO\tTEST.backendRefs\t\t{\"origin\": \"bnVsbA==\"}"
      },
      {
        "line": "I0727 11:18:08.445615       1 leaderelection.go:257] attempting to acquire leader lease kong-mesh-system/cp-leader-lease..."
      },
      {
        "line": "I0727 11:18:08.452263       1 leaderelection.go:271] successfully acquired lease kong-mesh-system/cp-leader-lease"
      },
      {
        "line": "2025/08/09 08:35:20 http: TLS handshake error from 10.42.0.1:57578: write tcp 10.42.0.192:5443->10.42.0.1:57578: write: broken pipe"
      }
    ]
  }
}
