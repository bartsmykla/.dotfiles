{
  "$schema": "https://lnav.org/schemas/format-v1.schema.json",
  "ecs_kuma_control_plane_logs": {
    "title": "ECS Kuma/Kong Mesh control plane log / CSV",
    "regex": {
      "std": {
        "pattern": "^(?<timestamp>[^,]+),(?<service_prefix>ecs\/universalcontrolplane-services\/)(?<service>[^,]+),(?<log_timestamp>[^,]+),(?<level>[^,]+),(?<logger>[^,]+),(?<message>[^,]+)(?:,(?<properties>.*))?$"
      }
    },
    "multiline": true,
    "ordered-by-time": false,
    "timestamp-format": ["%i"],
    "level-field": "level",
    "level": {
      "debug": "^DEBUG$",
      "info": "^INFO$",
      "warning": "^WARN$",
      "error": "^ERROR$",
      "fatal": "^FATAL$"
    },
    "value": {
      "service_prefix": {
        "kind": "string",
        "hidden": true
      },
      "service": {
        "kind": "string",
        "identifier": true
      },
      "log_timestamp": {
        "kind": "string",
        "hidden": true
      },
      "level": {
        "kind": "string",
        "identifier": true
      },
      "logger": {
        "kind": "string",
        "identifier": true
      },
      "message": {
        "kind": "string"
      },
      "properties": {
        "kind": "json"
      }
    },
    "sample": [
      {
        "line": "1758999939984,ecs/universalcontrolplane-services/41b8e2de508b406e94c623205f0fe0dd,2025-09-27T19:05:39.984Z,DEBUG,opa-server,on tick,{\"streamID\": 377, \"node\": \"id:\\\"mobile-cuw-mesh.ip-10-37-146-117\\\" metadata:{fields:{key:\\\"features\\\" value:{list_value:{values:{string_value:\\\"configurable-decision-path\\\"}}}}}\"}\n"
      }
    ]
  }
}
